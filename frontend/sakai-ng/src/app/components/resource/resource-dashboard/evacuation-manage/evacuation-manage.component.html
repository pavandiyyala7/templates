<div class="card">
    <div class="header-box">
        <p class="page-header">EVACUATION MANAGE</p>
        <div class="clock-container">
          <span>{{ currentDate }}</span> => <span>{{ currentTime }}</span>
        </div>
    </div>

    <div class="dashboard-container">
        <div class="grid">
            <div class="col-12 header-flex">
              <!-- <p-card > -->
                <div class="count-flex-box">
                    <div class="count-item">
                        <div class="count-flex">
                            <h5>LIVE HEADCOUNT </h5>
                            <i class="pi pi-users icon bg-blue"></i>
                        </div>
                        <span class="highlight">0</span>
                    </div>
                    <div class="count-item">
                        <div class="count-flex">
                            <h5> IN </h5>
                            <i class="pi pi-sign-in icon bg-breen"></i>
                        </div>
                        <span class="highlight">0</span>
                    </div>
                    <div class="count-item">
                        <div class="count-flex">
                            <h5> OUT </h5>
                            <i class="pi pi-sign-out icon bg-red"></i>
                        </div>
                        <span class="highlight">0</span>
                    </div>
                </div>
              <!-- </p-card> -->
            </div>
            
          </div>
          <div>
            <h5 class="category-tag">CATEGORISED</h5>
            <div class="p-grid">
                <div class="p-col-12 p-md-5 category-card" *ngFor="let category of categories">
                        <div [ngStyle]="{'background-color': category.color}">
                            <i [class]="category.icon"></i>
                            <span class="category-name">{{ category.name }}</span>
                            <span class="category-count">{{ category.count }}</span>
                        </div>
                    
                </div>
            </div>
            
        </div>
        
        <div class="flex-container">
    
          <div class="charts-container">
      
            <div class="vehicle-section">
              <div >
                <div *ngFor="let vehicle of vehicleData" class="vehicle-card">
                  @if(vehicle.icon !== 'fa'){
                    <svg xmlns="http://www.w3.org/2000/svg" class="b-icon" viewBox="0 0 650 512"><path d="M135.2 117.4L109.1 192l293.8 0-26.1-74.6C372.3 104.6 360.2 96 346.6 96L165.4 96c-13.6 0-25.7 8.6-30.2 21.4zM39.6 196.8L74.8 96.3C88.3 57.8 124.6 32 165.4 32l181.2 0c40.8 0 77.1 25.8 90.6 64.3l35.2 100.5c23.2 9.6 39.6 32.5 39.6 59.2l0 144 0 48c0 17.7-14.3 32-32 32l-32 0c-17.7 0-32-14.3-32-32l0-48L96 400l0 48c0 17.7-14.3 32-32 32l-32 0c-17.7 0-32-14.3-32-32l0-48L0 256c0-26.7 16.4-49.6 39.6-59.2zM128 288a32 32 0 1 0 -64 0 32 32 0 1 0 64 0zm288 32a32 32 0 1 0 0-64 32 32 0 1 0 0 64z"/></svg>
                  }
                  @if(vehicle.icon === 'fa'){
                    <svg xmlns="http://www.w3.org/2000/svg" class="b-icon" viewBox="0 0 650 512"><path d="M280 32c-13.3 0-24 10.7-24 24s10.7 24 24 24l57.7 0 16.4 30.3L256 192l-45.3-45.3c-12-12-28.3-18.7-45.3-18.7L64 128c-17.7 0-32 14.3-32 32l0 32 96 0c88.4 0 160 71.6 160 160c0 11-1.1 21.7-3.2 32l70.4 0c-2.1-10.3-3.2-21-3.2-32c0-52.2 25-98.6 63.7-127.8l15.4 28.6C402.4 276.3 384 312 384 352c0 70.7 57.3 128 128 128s128-57.3 128-128s-57.3-128-128-128c-13.5 0-26.5 2.1-38.7 6L418.2 128l61.8 0c17.7 0 32-14.3 32-32l0-32c0-17.7-14.3-32-32-32l-20.4 0c-7.5 0-14.7 2.6-20.5 7.4L391.7 78.9l-14-26c-7-12.9-20.5-21-35.2-21L280 32zM462.7 311.2l28.2 52.2c6.3 11.7 20.9 16 32.5 9.7s16-20.9 9.7-32.5l-28.2-52.2c2.3-.3 4.7-.4 7.1-.4c35.3 0 64 28.7 64 64s-28.7 64-64 64s-64-28.7-64-64c0-15.5 5.5-29.7 14.7-40.8zM187.3 376c-9.5 23.5-32.5 40-59.3 40c-35.3 0-64-28.7-64-64s28.7-64 64-64c26.9 0 49.9 16.5 59.3 40l66.4 0C242.5 268.8 190.5 224 128 224C57.3 224 0 281.3 0 352s57.3 128 128 128c62.5 0 114.5-44.8 125.8-104l-66.4 0zM128 384a32 32 0 1 0 0-64 32 32 0 1 0 0 64z"/></svg>
                  }
                  <div class="vehicle-info">
                    <p class="count">{{ vehicleCounts[vehicle.type] }}</p>
                    <p class="count">{{vehicle.totalSlots}}/{{vehicle.filledSlots}}</p>
                    <p class="type">{{ vehicle.type }}</p>
                  </div>
                </div>
              </div>
              <h4 class="total-count">Filled Slots: {{ totalFilledSlots() }}</h4>
            </div>
      
            <div class="gender-summary-card">
                <div class="gender-summary-item">
                  <i class="pi pi-user gender-summary-icon male"></i>
                  <div class="gender-summary-text">
                    <h3 class="gender-count">{{ genderCounts['Male'] || 0 }}</h3>
                    <p>Male</p>
                  </div>
                </div>
                <div class="gender-summary-item">
                  <i class="pi pi-user gender-summary-icon female"></i>
                  <div class="gender-summary-text">
                    <h3 class="gender-count">{{ genderCounts['Female'] || 0 }}</h3>
                    <p>Female</p>
                  </div>
                </div>
              </div>
            
            <div class="summary-card">
              <div class="summary-header">Total Employees</div>
              <div class="summary-content">
                <i class="pi pi-users employee-icon"></i>
                <h2 class="count">{{ employees.length }}</h2>
              </div>
            </div>
            
            
              <div class="small-flex-container">
                <div class="donut-card">
                  <h4 class="header">Employee Type</h4>
                  <div class="donut">
                    <p-chart 
                      type="doughnut"
                      [data]="employeeTypeChartData"
                      [options]="donutChartOptions"
                      [plugins]="plugins">
                    </p-chart>
                  </div>
                </div>
                <div class="donut-card">
                  <h4 class="header">Civil Status Distribution</h4>
                  <div class="donut">
                    <p-chart 
                      type="doughnut"
                      [data]="civilStatusChartData"
                      [options]="donutChartOptions"
                      [plugins]="plugins">
                    </p-chart>
                  </div>
                </div>
                
                
                <div class="age-card">
                  <h4 class="header">Age Distribution</h4>
                    <div class="age-bar">
                      <p-chart type="bar" [data]="ageChartData" [options]="chartOptions" [plugins]="plugins"></p-chart>
                    </div>
                  </div>
              </div>

              <div class="flex-box">
                <div class="emp-other-card">
                  <h4 class="header">Employment Status </h4>
                  <div class="work-bar">
                    <p-chart type="bar" [data]="employmentStatusChartData" [options]="vChartOptions" [plugins]="plugins"></p-chart>
                  </div>
                </div>
                
                <div class="emp-other-card">
                  <h4 class="header">Others</h4>
                  <div class="work-bar">
                    <p-chart type="bar"  [data]="othersChartData" [options]="vChartOptions" [plugins]="plugins"></p-chart>
                  </div>
                </div>
              </div>
          </div>
      
          <div class="summary-container">
            <div class="card wide">
              <h4 class="header">Department Strength</h4>
              <div class="dep-bar">
                <button (click)="previousSlide()"><</button>
                <canvas #departmentChart ></canvas>
                <button (click)="nextSlide()">></button>
              </div>
            </div>
          
            <div class="card work-wide">
              <h4 class="header">Work Permit</h4>
              <div class="work-bar ">
                <p-chart type="bar" [data]="workPermitChartData" [options]="perChartOptions" [plugins]="plugins"></p-chart>
              </div>
            </div>
          </div>
        </div>
    </div>
</div>
